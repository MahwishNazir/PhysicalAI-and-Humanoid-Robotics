# Research: Docusaurus Book Interface Setup

**Date**: 2025-12-03
**Feature**: 001-docusaurus-setup
**Phase**: 0 - Research & Outline

## Overview

This document captures research findings for setting up Docusaurus as a book authoring platform with hierarchical navigation supporting parts, chapters, and sections.

## 1. Sidebar Configuration for Book Hierarchies

### Decision: Use Autogenerated Sidebars with Category Definitions

**Rationale**: Autogenerated sidebars reduce maintenance overhead and automatically reflect the file system structure, making it easier to add and reorganize chapters without manual configuration updates.

**Implementation Approach**:

```javascript
// sidebars.js
module.exports = {
  bookSidebar: [
    {
      type: 'autogenerated',
      dirName: '.' // Generate from docs root
    }
  ]
};
```

**Category-Based Structure**: Docusaurus creates categories automatically from folders. Each folder becomes a sidebar category with nested items.

```javascript
// Alternative: Manual category definition for explicit control
export default {
  bookSidebar: [
    {
      type: 'category',
      label: 'Part I: Introduction',
      items: [
        { type: 'doc', id: 'part-01/chapter-01' },
        { type: 'doc', id: 'part-01/chapter-02' }
      ]
    },
    {
      type: 'category',
      label: 'Part II: Advanced Topics',
      items: [
        { type: 'doc', id: 'part-02/chapter-03' }
      ]
    }
  ]
};
```

**Alternatives Considered**:
- **Full manual sidebar definition**: Provides complete control but requires updating sidebars.js for every new chapter
- **Flat structure without categories**: Simpler but loses book-like "parts" organization
- **Multiple sidebars**: Could separate different book sections, but adds complexity for a single book

**Best Practice**: Mirror file system to sidebar structure, use autogeneration, and customize URLs with frontmatter slug if needed.

**Source**: [Docusaurus Sidebar Documentation](https://docusaurus.io/docs/sidebar)

## 2. Content Organization and File Structure

### Decision: Folder-per-Part with Numbered Chapters

**Rationale**: Clear hierarchical structure that visually represents book organization. Numbering ensures predictable ordering.

**Recommended Structure**:

```text
docs/
├── intro.md                    # Book introduction (homepage)
├── part-01-foundations/        # Part I
│   ├── _category_.json         # Part metadata
│   ├── 01-chapter-one.md
│   ├── 02-chapter-two.md
│   └── 03-chapter-three.md
├── part-02-advanced/           # Part II
│   ├── _category_.json
│   ├── 01-first-chapter.md
│   └── 02-second-chapter.md
└── appendix/
    ├── _category_.json
    ├── glossary.md
    └── references.md
```

**File Naming Convention**:
- **Parts**: `part-##-descriptive-name/` (e.g., `part-01-foundations/`)
- **Chapters**: `##-descriptive-title.md` (e.g., `01-getting-started.md`)
- **Special files**: Use semantic names (`intro.md`, `glossary.md`, `references.md`)

**_category_.json Structure**:

```json
{
  "label": "Part I: Foundations",
  "position": 1,
  "collapsible": true,
  "collapsed": false
}
```

**Alternatives Considered**:
- **No numbering**: Relies on alphabetical or position frontmatter (less predictable)
- **Deep nesting**: Chapters with subsections as separate files (too granular for book structure)
- **Flat structure**: All chapters in one folder with prefixes (loses part organization)

**Best Practices**:
- Mirror file system to sidebar structure
- Use descriptive folder/file names for clarity
- Prefix with numbers for explicit ordering
- Files named `index`, `README`, or matching parent folder exclude that segment from URLs

**Sources**:
- [Create a Doc | Docusaurus](https://docusaurus.io/docs/create-doc)
- [Best practices for managing large documentation | GitHub Discussion](https://github.com/facebook/docusaurus/discussions/11171)

## 3. Frontmatter Schema for Chapter Metadata

### Decision: Standardized Frontmatter Fields for Book Content

**Rationale**: Frontmatter provides structured metadata for each chapter, enabling customization of titles, navigation labels, and URLs while keeping content separate from metadata.

**Standard Chapter Frontmatter**:

```yaml
---
id: chapter-unique-id
title: "Chapter Title Displayed in Content"
sidebar_label: "Short Nav Label"
sidebar_position: 1
description: "Brief chapter description for SEO and previews"
tags: [topic1, topic2]
slug: /part-01/chapter-name
---
```

**Field Definitions**:

| Field | Purpose | Required | Default |
|-------|---------|----------|---------|
| `id` | Unique document identifier | No | Derived from filename |
| `title` | Full chapter title displayed on page | No | Inferred from first heading |
| `sidebar_label` | Shorter label for navigation | No | Uses `title` or filename |
| `sidebar_position` | Explicit ordering (alternative to numbering) | No | Alphabetical |
| `description` | Chapter summary for SEO/previews | No | First paragraph excerpt |
| `slug` | Custom URL path | No | Derived from file path |
| `tags` | Categorization tags | No | None |
| `draft` | Hide from production build | No | `false` |

**Example Usage**:

```markdown
---
title: "Getting Started with Docusaurus"
sidebar_label: "Getting Started"
sidebar_position: 1
description: "Learn how to set up and configure Docusaurus for your book project"
tags: [setup, beginner]
---

# Getting Started with Docusaurus

Chapter content begins here...
```

**Custom Metadata (Optional)**:

```yaml
---
title: "Chapter Title"
custom_edit_url: null  # Disable edit links
hide_table_of_contents: false
keywords: [keyword1, keyword2]
image: /img/chapter-preview.png
---
```

**Alternatives Considered**:
- **Minimal frontmatter**: Rely on defaults (less control over navigation/SEO)
- **External metadata file**: Separate metadata.json (adds complexity, harder to maintain)
- **Filename-only organization**: No frontmatter (limited customization)

**Best Practices**:
- Use `slug` to decouple URLs from file structure for flexibility
- Set `sidebar_label` for concise navigation when `title` is long
- Add `description` for all chapters to improve search/SEO
- Use `tags` to enable cross-cutting topic navigation

**Sources**:
- [Docusaurus Markdown Features](https://docusaurus.io/docs/markdown-features)
- [Create a Doc | Docusaurus](https://docusaurus.io/docs/create-doc)

## 4. Theme Customization for Book Reading Experience

### Decision: Classic Theme with Minimal Customization

**Rationale**: Docusaurus classic theme provides a clean, distraction-free reading experience out-of-the-box. Avoid heavy customization to maintain simplicity and upgradability.

**Configuration Approach**:

```javascript
// docusaurus.config.js
module.exports = {
  themeConfig: {
    navbar: {
      title: 'Book Title',
      hideOnScroll: false,
      items: [
        {
          type: 'search',
          position: 'right',
        },
      ],
    },
    footer: {
      style: 'dark',
      copyright: `Copyright © ${new Date().getFullYear()} Author Name`,
    },
    docs: {
      sidebar: {
        hideable: true,
        autoCollapseCategories: true,
      },
    },
    colorMode: {
      defaultMode: 'light',
      disableSwitch: false,
      respectPrefersColorScheme: true,
    },
  },
};
```

**Theme Options for Book Experience**:

- **`hideable` sidebar**: Allows readers to hide sidebar for distraction-free reading
- **`autoCollapseCategories`**: Keeps sidebar focused on current section
- **`hideOnScroll` navbar**: Can enable to maximize reading space
- **Color mode**: Support light/dark themes for reader preference

**Typography and Readability** (via custom CSS if needed):

```css
/* src/css/custom.css */
:root {
  --ifm-font-size-base: 16px;
  --ifm-line-height-base: 1.75;
  --ifm-leading-desktop: 1.75;
}

.markdown {
  max-width: 720px; /* Optimal reading width */
}
```

**Alternatives Considered**:
- **Heavy theme customization**: Custom React components (out of scope, adds complexity)
- **Third-party themes**: Limited options, potential maintenance issues
- **Fully custom design**: Defeats purpose of using Docusaurus

**Limitations**:
- Limited built-in book-specific features (no chapter prev/next navigation by default - available via docs plugin)
- No built-in PDF export (out of scope)
- Not optimized for print layout (web-first design)

**Best Practices**:
- Use classic theme defaults as baseline
- Customize only through configuration, avoid custom components
- Test on mobile devices to ensure responsive reading experience
- Enable dark mode for accessibility

**Sources**:
- [Docusaurus Configuration](https://docusaurus.io/docs/configuration)
- [Docusaurus Theming](https://docusaurus.io/docs/styling-layout)

## 5. Search Configuration

### Decision: Use Built-in Docusaurus Search (Client-Side)

**Rationale**: Docusaurus includes client-side search out-of-the-box with no configuration needed. For a single-author book project, this is sufficient and avoids external dependencies.

**Default Search Behavior**:
- **Client-side search**: Automatically indexes all markdown content
- **Zero configuration**: Works immediately after setup
- **Search location**: Navbar search box (right side by default)

**Configuration** (already included in theme):

```javascript
// docusaurus.config.js
module.exports = {
  themeConfig: {
    navbar: {
      items: [
        {
          type: 'search',
          position: 'right',
        },
      ],
    },
  },
};
```

**Advanced Search Options** (if needed later):

1. **Algolia DocSearch** (external service):
   - Requires application and approval
   - Server-side search with better performance
   - Out of scope for initial setup

2. **Local Search Plugin**:
   ```bash
   npm install --save @easyops-cn/docusaurus-search-local
   ```
   - Offline-capable search
   - More customizable than default
   - Consider if default search is insufficient

**Search Performance**:
- Default search is fast for small-to-medium books (<100 pages)
- Indexes content on page load (client-side)
- No server/API dependencies

**Alternatives Considered**:
- **Algolia DocSearch**: Requires external service, approval process (overkill for local dev)
- **Custom search implementation**: Unnecessary complexity
- **No search**: Poor user experience for navigation

**Limitations**:
- Client-side search has performance limits with very large books (>1000 pages)
- No advanced features (fuzzy search, filtering, etc.) without plugins

**Best Practices**:
- Start with default search (sufficient for most books)
- Upgrade to Algolia or local search plugin only if needed
- Ensure all chapters have good `title` and `description` frontmatter for search quality

**Sources**:
- [Docusaurus Search Documentation](https://docusaurus.io/docs/search)

## Summary of Decisions

| Aspect | Decision | Rationale |
|--------|----------|-----------|
| **Sidebar** | Autogenerated with categories | Low maintenance, reflects file structure |
| **File Structure** | Folders per part, numbered chapters | Clear hierarchy, explicit ordering |
| **Frontmatter** | Standard fields (title, sidebar_label, slug, description) | Metadata control, SEO, navigation customization |
| **Theme** | Classic theme, minimal customization | Clean reading experience, maintainability |
| **Search** | Built-in client-side search | Zero config, sufficient for book-sized content |

## Implementation Readiness

All research questions resolved. No critical unknowns remaining. Ready to proceed to Phase 1: Design & Contracts.

## References

- [Sidebar | Docusaurus](https://docusaurus.io/docs/sidebar)
- [Create a Doc | Docusaurus](https://docusaurus.io/docs/create-doc)
- [Markdown Features | Docusaurus](https://docusaurus.io/docs/markdown-features)
- [Best practices for managing large documentation | GitHub](https://github.com/facebook/docusaurus/discussions/11171)
